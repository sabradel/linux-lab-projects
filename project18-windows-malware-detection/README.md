# Project 18: Windows Malware Detection & Investigation (Wazuh + Defender)

## Objective

Simulate a real malware detection on a Windows 10 endpoint using the EICAR test file, detect it with Microsoft Defender, and investigate the alert using Wazuh SIEM.

This project demonstrates how a SOC analyst detects, triages, and investigates malware alerts from endpoint security tools.

---

## Lab Environment

- Wazuh Manager: Debian Linux
- Wazuh Agent: Windows 10
- Attacker Simulation: EICAR test string
- Security Tools:
  - Microsoft Defender Antivirus
  - Wazuh SIEM

---

# Project 18: Windows Malware Detection (EICAR) + Wazuh SIEM

## Goal
Simulate a malware detection on Windows and confirm Wazuh receives and shows the alert.

## Lab
- Windows 10 with Wazuh Agent
- Wazuh Manager
- Microsoft Defender

## Step 1 — Trigger malware test
I used the EICAR test string to trigger Microsoft Defender.

Screenshots:
- screenshots/01-defender-event-1116-detection.png
- screenshots/02-defender-event-1117-action.png
- screenshots/06-windows-security-current-threats.png

## Step 2 — Configure Wazuh to read Defender logs
I configured ossec.conf to read:
Microsoft-Windows-Windows Defender/Operational

Screenshot:
- screenshots/05-ossec-conf-localfile-defender.png

## Step 3 — Confirm logs in Wazuh
I checked Wazuh Discover and confirmed the EICAR event is visible.

Screenshots:
- screenshots/03-wazuh-discover-eicar-event.png
- screenshots/04-wazuh-defender-operational-hits.png

## Result
- Detection type: Malware (EICAR test)
- Classification: True Positive (Test)
- Defender successfully blocked it
- Wazuh successfully collected and displayed it

## Skills Demonstrated
- Malware detection
- Windows Defender logging
- Wazuh SIEM investigation
- SOC alert validation
